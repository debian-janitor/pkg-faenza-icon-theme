#!/usr/bin/make -f

PACKAGE_DIR=$(CURDIR)/debian/faenza-icon-theme

%:
	dh $@

override_dh_install:
	sh debian/create-symlinks.sh

	dh_install

	rdfind -outputname /dev/null -makesymlinks true $(PACKAGE_DIR)
	symlinks -c -r -s $(PACKAGE_DIR)

	find $(PACKAGE_DIR) -iname "*.png" -type f -print0 | parallel -0 --eta 'optipng -o4 {}'
	find $(PACKAGE_DIR) -iname "*.png" -type f -print0 | parallel -0 --eta 'advpng -z3 {}'
	find $(PACKAGE_DIR) -iname "*.png" -type f -print0 | parallel -0 --eta 'advpng -z4 {}'
	find $(PACKAGE_DIR) -iname "*.png" -type f -print0 | parallel -0 --eta 'advdef -z3 {}'
	find $(PACKAGE_DIR) -iname "*.png" -type f -print0 | parallel -0 --eta 'advdef -z4 {}'

	find $(PACKAGE_DIR) -type f -print0 | xargs -0 chmod a-x
	rm -Rf $(PACKAGE_DIR)/usr/share/icons/Faenza/extras
	rm -Rf $(PACKAGE_DIR)/usr/share/icons/Faenza-Dark/extras

override_dh_builddeb:
	dh_builddeb -- -Zxz -Sextreme
